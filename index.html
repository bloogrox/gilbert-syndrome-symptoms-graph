<!DOCTYPE html>
<html>
    <head>
        <link rel="stylesheet" href="styles.css" />
    </head>
    <body>
        <main id="app">
            <router-view></router-view>
        </main>
        <script src="https://github.com/tonsky/datascript/releases/download/1.3.13/datascript-1.3.13.min.js"></script>
        <script src="https://unpkg.com/vue@3.2.37/dist/vue.global.js"></script>
        <script src="https://unpkg.com/vue-router@4.0.15/dist/vue-router.global.js"></script>
        <script src="https://cdn.jsdelivr.net/gh/nextapps-de/flexsearch@0.7.2/dist/flexsearch.bundle.js"></script>
        <script src="data.js"></script>
        <script>
            const schema = {
                "text": {":db/type": ":db.type/string"},
                "caused-by": {":db/cardinality": ":db.cardinality/many"}
            }
            let db = datascript.db_with(
                datascript.empty_db(schema),
                data
            );

            let searchIndex = new FlexSearch.Index({
                // preset: "match",
                tokenize: "full",
            });

            const query = `
                [
                    :find ?e ?t
                    :where
                    [?e "text" ?t]
                ]
            `;
            datascript.q(query, db).map(([id_, text_]) => {searchIndex.add(id_, text_)});
        </script>
        <script src="app.js"></script>
    </body>
</html>
